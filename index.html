<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#050607">
  <title>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ ‚Äî –ø—Ä–æ–≥—Ä–∞–º–º—ã + –∂—É—Ä–Ω–∞–ª</title>
  <link rel="icon" type="image/png" href="data:image/png;base64,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">
  <link rel="apple-touch-icon" href="data:image/png;base64,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">
<style>
    :root{
      --bg:#0b0c0e;
      --card:#111317;
      --card2:#0f1114;
      --line: rgba(255,255,255,.10);
      --line2: rgba(255,255,255,.16);
      --text:#f4f6f8;
      --muted: rgba(244,246,248,.72);
      --muted2: rgba(244,246,248,.56);

      --r1: 16px;
      --r2: 20px;

      --shadow: 0 10px 24px rgba(0,0,0,.45);
      --shadow2: 0 6px 16px rgba(0,0,0,.35);

      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: -apple-system, BlinkMacSystemFont, "SF Pro Display", "SF Pro Text", system-ui, Segoe UI, Roboto, Ubuntu, Arial;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    html{-webkit-text-size-adjust:100%;}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background: var(--bg);
      min-height: 100vh;
      padding-top: env(safe-area-inset-top);
      padding-bottom: env(safe-area-inset-bottom);
      padding-left: env(safe-area-inset-left);
      padding-right: env(safe-area-inset-right);
      overflow-x:hidden;
      -webkit-overflow-scrolling: touch;
    }
    @supports (min-height: 100dvh){
      body{ min-height: 100dvh; }
    }
    *{ -webkit-tap-highlight-color: rgba(255,255,255,.08); }

    .wrap{
      max-width: 1100px;
      margin:0 auto;
      padding: 14px;
    }

    /* Top */
    .top{ display:flex; align-items:center; justify-content:center; padding: 10px 0 12px; }
    .brand{ width:100%; display:flex; align-items:center; justify-content:center; gap:10px; }
    .logo{ display:none; }
    h1{
      margin:0;
      font-size: 18px;
      letter-spacing:.2px;
      font-weight: 900;
    }

    /* Layout */
    .grid{ display:grid; grid-template-columns: 420px 1fr; gap:12px; align-items:start; }
    @media (max-width: 980px){
      .grid{ grid-template-columns: 1fr; }
      .sticky{ position: static; }
    }

    /* Card */
    .card{
      background: linear-gradient(180deg, var(--card), var(--card2));
      border: 1px solid var(--line);
      border-radius: var(--r2);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card:before{ content:none; }

    .sticky{ position: sticky; top: 12px; }

    .hdr{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding: 12px 12px;
      border-bottom: 1px solid var(--line);
      background: rgba(255,255,255,.02);
      backdrop-filter: blur(6px);
    }
    .hdr h2{
      margin:0;
      font-size: 12px;
      font-weight: 900;
      letter-spacing: .6px;
      text-transform: uppercase;
      color: var(--muted2);
    }
    .cardPad{ padding: 12px; }

    .small{ font-size: 12px; color: var(--muted2); }
    .note{ font-size: 12px; color: var(--muted); line-height: 1.35; }

    /* Form */
    label{
      display:block;
      font-size: 12px;
      color: var(--muted);
      margin: 10px 0 6px;
      font-weight: 800;
      letter-spacing: .2px;
    }
    input[type="date"], input[type="text"], select, textarea{
      width:100%;
      height: 44px;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.03);
      color: var(--text);
      outline:none;
      font-size: 16px;
    }
    textarea{
      height:auto;
      min-height: 110px;
      resize: vertical;
      padding: 12px;
    }
    input:focus, select:focus, textarea:focus{
      border-color: var(--line2);
    }
    input[type="date"]{ -webkit-appearance:none; appearance:none; }
    select{
      -webkit-appearance:none; appearance:none;
      background-image:
        linear-gradient(45deg, transparent 50%, rgba(255,255,255,.75) 50%),
        linear-gradient(135deg, rgba(255,255,255,.75) 50%, transparent 50%);
      background-position:
        calc(100% - 18px) calc(50% - 2px),
        calc(100% - 13px) calc(50% - 2px);
      background-size:5px 5px, 5px 5px;
      background-repeat:no-repeat;
      padding-right: 34px;
    }
    .row{ display:flex; gap:10px; flex-wrap:wrap; }
    .row > *{ flex:1; min-width: 160px; }

    /* Buttons */
    .btnRow{ display:flex; gap:10px; flex-wrap:wrap; margin-top: 10px; }
    button{
      cursor:pointer;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.03);
      color: var(--text);
      border-radius: 14px;
      padding: 12px 14px;
      min-height: 44px;
      font-weight: 900;
      letter-spacing: .2px;
      user-select:none;
    }
    button:active{ transform: translateY(1px); }
    button.primary{
      background: rgba(255,255,255,.10);
      border-color: rgba(255,255,255,.22);
    }
    button.danger{ background: rgba(255,255,255,.02); }
    button.small{
      min-height: 40px;
      padding: 10px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 900;
    }

    /* Progress + stats */
    .progressWrap{ margin-top: 10px; }
    .progressLine{
      height: 10px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.02);
      overflow:hidden;
    }
    .progressBar{
      height:100%;
      width:0%;
      background: rgba(255,255,255,.78);
      transition: width .2s ease;
    }
    .progressMeta{
      display:flex;
      justify-content:space-between;
      gap:10px;
      margin-top: 8px;
      font-size: 12px;
      color: var(--muted2);
      font-family: var(--mono);
    }

    .stats{ display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-top:10px; }
    .stat{
      border-radius: 16px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.02);
      overflow:hidden;
    }
    .stat:before{ content:none; }
    .statPad{ padding: 10px 12px; }
    .stat .k{
      font-size: 11px;
      color: var(--muted2);
      font-weight: 900;
      letter-spacing:.5px;
      text-transform: uppercase;
    }
    .stat .v{
      margin-top: 6px;
      font-family: var(--mono);
      font-size: 16px;
      color: var(--text);
    }

    /* Workout title area */
    .workTitle{ display:flex; justify-content:space-between; align-items:baseline; gap:10px; flex-wrap:wrap; }
    .workTitle h3{ margin:0; font-size: 16px; font-weight: 950; letter-spacing:.2px; }

    /* Exercise blocks */
    .ex{
      margin-top: 12px;
      border-radius: 18px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.02);
      overflow:hidden;
    }
    .ex:before{ content:none; }
    .exHead{
      padding: 12px 12px 10px;
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      align-items:flex-start;
      border-bottom: 1px solid rgba(255,255,255,.06);
    }
    .exName{
      margin:0;
      font-size: 13px;
      line-height: 1.25;
      font-weight: 900;
      letter-spacing:.15px;
    }
    .exMeta{ display:flex; gap:8px; flex-wrap:wrap; margin-top: 8px; }
    .tag{
      font-family: var(--mono);
      font-size: 12px;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.02);
      color: var(--muted);
    }
    .tag.muted{ color: var(--muted2); }

    .exDone{
      font-family: var(--mono);
      font-size: 12px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.02);
      color: var(--muted2);
      white-space: nowrap;
    }

    /* Sets */
    .setGrid{
      display:grid;
      grid-template-columns: 1fr;
      gap: 10px;
      padding: 12px;
    }
    .setRow{
      display:flex;
      align-items:center;
      gap:10px;
      min-height: 52px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.02);
      padding: 10px 12px;
      user-select:none;
    }
    .setRow input[type="checkbox"]{ width:18px; height:18px; accent-color: #ffffff; }
    .setRow .s{ font-size: 12px; color: var(--muted2); min-width: 70px; font-weight: 900; }

    .mini{
      width: 100%;
      height: 40px;
      padding: 8px 10px !important;
      border-radius: 14px !important;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.02);
      color: var(--text);
      font-family: var(--mono);
      font-size: 16px;
      outline:none;
    }
    .mini::placeholder{ color: rgba(244,246,248,.35); }
    .mini:focus{ border-color: var(--line2); }

    /* Details / sections */
    details{
      margin-top: 12px;
      border: 1px solid var(--line);
      border-radius: 18px;
      background: rgba(255,255,255,.02);
      overflow:hidden;
    }
    details:before{ content:none; }
    summary{
      cursor:pointer;
      padding: 12px 12px;
      font-weight: 950;
      letter-spacing: .2px;
      color: var(--text);
      list-style:none;
    }
    summary::-webkit-details-marker{ display:none; }
    .detailsPad{ padding: 0 12px 12px; }

    .historyItem{
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.02);
      border-radius: 16px;
      padding: 10px 10px;
      margin-top: 10px;
    }
    .historyTop{ display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap; }
    .historyTop .t{ font-weight: 950; letter-spacing:.15px; }
    .historyTop .s{ color: var(--muted2); font-size: 12px; font-family: var(--mono); }
    .historyBtns{ display:flex; gap:10px; flex-wrap:wrap; margin-top: 10px; }

    /* Timer */
    .timerBox{
      margin-top: 12px;
      border: 1px solid var(--line);
      border-radius: 18px;
      background: rgba(255,255,255,.02);
      overflow:hidden;
    }
    .timerBox:before{ content:none; }
    .timerPad{ padding: 10px 12px; }
    .timerTop{ display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap; align-items:baseline; }
    .timerTop .v{ font-family: var(--mono); font-size: 18px; }
    .timerTop .k{ font-size: 11px; color: var(--muted2); font-weight: 950; letter-spacing:.5px; text-transform: uppercase; }
    .timerBtns{ display:flex; gap:8px; flex-wrap:wrap; margin-top: 10px; }
    .timerBtns button.small{ flex:1; min-width: 0; }

    /* Mobile */
    @media (max-width: 520px){
      .wrap{ padding: 12px; }
      .hdr{ padding: 12px; }
      .cardPad{ padding: 12px; }
      .btnRow button{ width: 100%; }
      .timerBtns button.small{ flex:1; }
      .stats{ grid-template-columns: 1fr; }
      .row > *{ min-width: 140px; }
      h1{ font-size: 17px; }
    }

    /* iPhone UX fixes */
    input, select, textarea{ scroll-margin-top: 12px; }
    /* Prevent accidental overscroll glow */
    body{ overscroll-behavior-y: none; }

    /* Cat UI */
    .catBadge{
      margin-top: 6px;
      font-size: 12px;
      color: var(--muted2);
      font-weight: 900;
      letter-spacing:.2px;
      text-align:center;
    }
    .catBadge b{ color: var(--text); }
    .catFloat{
      position: fixed;
      right: 14px;
      bottom: calc(14px + env(safe-area-inset-bottom));
      width: 52px;
      height: 52px;
      border-radius: 16px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.04);
      color: var(--text);
      box-shadow: var(--shadow2);
      display:grid;
      place-items:center;
      font-size: 22px;
      z-index: 50;
    }
    .catFloat:active{ transform: translateY(1px); }

    .catToast{
      position: fixed;
      left: 50%;
      bottom: calc(76px + env(safe-area-inset-bottom));
      transform: translateX(-50%);
      padding: 10px 12px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(17,19,23,.92);
      color: var(--text);
      font-size: 12px;
      font-weight: 850;
      max-width: min(92vw, 520px);
      box-shadow: var(--shadow2);
      opacity: 0;
      pointer-events:none;
      transition: opacity .18s ease, transform .18s ease;
      z-index: 60;
    }
    .catToast.show{
      opacity: 1;
      transform: translateX(-50%) translateY(-2px);
    }
      25%{ opacity:.95; }
      100%{ transform: translateY(-80px) scale(1.05); opacity:0; }
    }

    /* Program picker (fix iPhone select/optgroup readability) */
    .pickBtn{
      width: 100%;
      min-height: 44px;
      border-radius: 14px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.03);
      color: var(--text);
      padding: 12px 14px;
      text-align: left;
      font-weight: 900;
      letter-spacing: .2px;
    }
    .pickBtn:active{ transform: translateY(1px); }

    .nativeSelect{ width:100%; }

    /* Desktop: use native select; Mobile: use sheet */
    @media (max-width: 520px){
      .nativeSelect{ display:none; }
      .pickBtn{ display:block; }
    }
    @media (min-width: 521px){
      .pickBtn{ display:none; }
      .nativeSelect{ display:block; }
      /* Make desktop dropdown readable */
      .nativeSelect, .nativeSelect option, .nativeSelect optgroup{ color: #000; background: #fff; }
    }

    /* Bottom sheet */
    .sheet{
      position: fixed;
      inset: 0;
      display: none;
      z-index: 80;
    }
    .sheet[aria-hidden="false"]{ display:block; }
    .sheetBackdrop{
      position:absolute;
      inset:0;
      background: rgba(0,0,0,.55);
    }
    .sheetCard{
      position:absolute;
      left: 0; right: 0;
      bottom: 0;
      background: linear-gradient(180deg, var(--card), var(--card2));
      border-top-left-radius: 22px;
      border-top-right-radius: 22px;
      border: 1px solid rgba(255,255,255,.10);
      box-shadow: var(--shadow);
      padding-bottom: calc(12px + env(safe-area-inset-bottom));
      max-height: 84vh;
      overflow: hidden;
    }
    .sheetTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding: 12px 12px;
      border-bottom: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.02);
    }
    .sheetTitle{
      font-size: 13px;
      font-weight: 950;
      letter-spacing:.2px;
      color: var(--text);
    }
    .sheetClose{
      width: 40px;
      height: 40px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      color: var(--text);
      font-weight: 950;
    }
    .sheetBody{ padding: 12px; overflow:auto; max-height: 84vh; }
    .sheetSearch{
      width: 100%;
      height: 44px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      color: var(--text);
      padding: 10px 12px;
      font-size: 16px;
      outline:none;
      margin-bottom: 10px;
    }
    .sheetSearch:focus{ border-color: rgba(255,255,255,.18); }
    .sheetList{ display:flex; flex-direction:column; gap:10px; }
    .sheetGroup{
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 16px;
      overflow:hidden;
      background: rgba(255,255,255,.02);
    }
    .sheetGroupTitle{
      padding: 10px 12px;
      font-size: 11px;
      font-weight: 950;
      letter-spacing:.6px;
      text-transform: uppercase;
      color: var(--muted2);
      border-bottom: 1px solid rgba(255,255,255,.08);
    }
    .sheetItem{
      padding: 12px 12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      border-top: 1px solid rgba(255,255,255,.06);
      color: var(--text);
      background: transparent;
    }
    .sheetItem:first-of-type{ border-top:none; }
    .sheetItem:active{ background: rgba(255,255,255,.04); }
    .sheetName{ font-weight: 900; font-size: 14px; }
    .sheetCode{ font-family: var(--mono); font-size: 12px; color: var(--muted2); }

    /* Cat redesign (minimal) */
    .catWidget{
      margin-top: 10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding: 10px 12px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.02);
    }
    .catFace{
      font-size: 22px;
      line-height: 1;
    }
    .catToggleSmall{
      width: 44px;
      height: 44px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      color: var(--text);
      font-weight: 950;
    }

    /* Toast */
    .catToast{
      position: fixed;
      left: 50%;
      bottom: calc(14px + env(safe-area-inset-bottom));
      transform: translateX(-50%);
      padding: 10px 12px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(17,19,23,.92);
      color: var(--text);
      font-size: 12px;
      font-weight: 850;
      max-width: min(92vw, 520px);
      box-shadow: var(--shadow2);
      opacity: 0;
      pointer-events:none;
      transition: opacity .18s ease, transform .18s ease;
      z-index: 90;
    }
    .catToast.show{
      opacity: 1;
      transform: translateX(-50%) translateY(-2px);
    }

    /* Cat rain */
    .catRain{
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 95;
      overflow: hidden;
    }
    .catDrop{
      position: absolute;
      top: -40px;
      font-size: 22px;
      will-change: transform, opacity;
      filter: drop-shadow(0 8px 12px rgba(0,0,0,.35));
      animation: catfall var(--dur) linear forwards;
      opacity: .95;
    }
    @keyframes catfall{
      0%{ transform: translate3d(0,0,0) rotate(var(--rot)); opacity: 0; }
      10%{ opacity: .95; }
      100%{ transform: translate3d(0, calc(100vh + 80px), 0) rotate(calc(var(--rot) + 80deg)); opacity: 0; }
    }
    @supports (height: 100dvh){
      @keyframes catfall{
        0%{ transform: translate3d(0,0,0) rotate(var(--rot)); opacity: 0; }
        10%{ opacity: .95; }
        100%{ transform: translate3d(0, calc(100dvh + 80px), 0) rotate(calc(var(--rot) + 80deg)); opacity: 0; }
      }
    }

    /* Easter egg: cat widget hidden until unlocked */
    .catWidget{ display:none; }
    body.egg .catWidget{ display:flex; }

    /* iPhone adaptation pass */
    @media (max-width: 520px){
      .wrap{ padding: 12px; }
      .grid{ grid-template-columns: 1fr; gap: 12px; }
      .sticky{ position: static; top:auto; }
      .top{ padding: 8px 0 10px; }
      h1{ font-size: 17px; }
      .row{ gap: 8px; }
      .row > *{ min-width: 140px; }
      .btnRow{ gap: 8px; }
      .btnRow button{ width: 100%; }
      .timerBtns{ gap: 8px; }
      .timerBtns button.small{ flex:1; }
      .stats{ grid-template-columns: 1fr; }
      /* Date compact */
      input[type="date"], select{ height: 42px; padding: 9px 10px; }
      /* Reduce list density a bit */
      .exHead{ padding: 12px 12px 10px; }
      .setGrid{ padding: 12px; gap: 10px; }
      .setRow{ padding: 10px 12px; }
      /* Bottom sheet height */
      .sheetCard{ max-height: 86vh; }
      .sheetBody{ max-height: 86vh; }
    }
    /* Prevent iOS zoom on any text input */
    input[type="text"], textarea, .mini{ font-size: 16px; }

    @media (prefers-reduced-motion: reduce){
      *{ transition:none !important; scroll-behavior:auto !important; }
    }
</style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <div class="brand">
        <div class="logo" aria-hidden="true">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
            <path d="M7 20V10.5C7 8.01472 9.01472 6 11.5 6H13C15.7614 6 18 8.23858 18 11V20" stroke="rgba(255,255,255,.88)" stroke-width="1.8" stroke-linecap="round"/>
            <path d="M6 14h13" stroke="rgba(255,255,255,.70)" stroke-width="1.8" stroke-linecap="round"/>
          </svg>
        </div>
        <div>
          <h1>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</h1>
</div>
      </div>
</div>

    <div class="grid">
      <aside class="card sticky">
        <div class="hdr">
          <h2>–ü–∞–Ω–µ–ª—å</h2>
</div>
        <div class="cardPad">
          <div class="row">
            <div>
              <label for="date">–î–∞—Ç–∞</label>
              <input id="date" type="date" />
            </div>
            <div>
              <label for="template">–®–∞–±–ª–æ–Ω –Ω–µ–¥–µ–ª–∏</label>
              <select id="template">
                <option value="4_hyp">4√ó/–Ω–µ–¥ (–º–∞—Å—Å–∞ PPL+G)</option>
                <option value="3_fb">3√ó/–Ω–µ–¥ (full body)</option>
                <option value="5_str">5√ó/–Ω–µ–¥ (—Å–∏–ª–æ–≤–æ–π)</option>
                <option value="6_ppl">6√ó/–Ω–µ–¥ (PPL√ó2)</option>
              </select>
            </div>
          </div>

          <label for="program">–ü—Ä–æ–≥—Ä–∞–º–º–∞</label>
          <button id="programBtn" class="pickBtn" type="button" aria-haspopup="dialog" aria-controls="programSheet">‚Äî</button>
          <select id="program" class="nativeSelect"></select>
          <div id="catWidget" class="catWidget" aria-label="–∫–æ—Ç–∏–∫">
            <div class="catFace" id="catFace">üò∫</div>
            <button id="catToggleSmall" class="catToggleSmall" type="button" aria-label="–∫–æ—Ç–∏–∫–∏ –≤–∫–ª/–≤—ã–∫–ª">üêæ</button>
          </div>
<div class="btnRow">
            <button class="primary" id="btnToday">–°–µ–≥–æ–¥–Ω—è / –°–ª–µ–¥—É—é—â–∞—è</button>
            <button id="btnSave">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∂—É—Ä–Ω–∞–ª</button>
          </div>

          <div class="btnRow" style="margin-top:10px">
            <button class="danger" id="btnReset">–°–±—Ä–æ—Å–∏—Ç—å –≤–≤–æ–¥ (–¥–∞—Ç–∞+–ø—Ä–æ–≥–∞)</button>
            <button id="btnCopy">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∑–∞–º–µ—Ç–∫—É</button>
          </div>

          <div class="progressWrap">
            <div class="progressLine"><div class="progressBar" id="progressBar"></div></div>
            <div class="progressMeta">
              <span id="progressText">0%</span>
              <span id="progressSets">0/0 –ø–æ–¥—Ö–æ–¥–æ–≤</span>
            </div>
          </div>

          <div class="stats">
            <div class="stat"><div class="statPad">
              <div class="k">–¢–æ–Ω–Ω–∞–∂</div>
              <div class="v" id="tonnage">0 –∫–≥</div>
            </div></div>
            <div class="stat"><div class="statPad">
              <div class="k">–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–π</div>
              <div class="v" id="exCount">0</div>
            </div></div>
          </div>

          <div class="timerBox">
            <div class="timerPad">
              <div class="timerTop">
                <div>
                  <div class="k">–¢–∞–π–º–µ—Ä –æ—Ç–¥—ã—Ö–∞</div>
                  <div class="v" id="timerText">00:00</div>
                </div>
                <div class="small" id="timerState">‚Äî</div>
              </div>
              <div class="timerBtns">
                <button class="small" data-t="60">60—Å</button>
                <button class="small" data-t="90">90—Å</button>
                <button class="small" data-t="120">120—Å</button>
                <button class="small" data-t="180">180—Å</button>
                <button class="small" id="timerStop">–°—Ç–æ–ø</button>
              </div>
            </div>
          </div>

          <details open>
            <summary>–ñ—É—Ä–Ω–∞–ª (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 12)</summary>
            <div class="detailsPad" id="history"></div>
          </details>

          <details>
            <summary>–ü–æ–∏—Å–∫ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</summary>
            <div class="detailsPad">
              <label for="search">–ù–æ–º–µ—Ä –∏–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ</label>
              <input id="search" type="text" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: 05-03 –∏–ª–∏ '–∂–∏–º' –∏–ª–∏ '–ø–æ–¥—Ç—è–≥'" />
              
              <div id="searchResults"></div>
            </div>
          </details>

          <details>
            <summary>–ò–º–ø–æ—Ä—Ç/—ç–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ–≥—Ä–∞–º–º</summary>
            <div class="detailsPad">
              <div class="btnRow">
                <button class="small" id="btnExport">–≠–∫—Å–ø–æ—Ä—Ç</button>
                <button class="small" id="btnImport">–ò–º–ø–æ—Ä—Ç</button>
                <button class="small" id="btnResetPrograms">–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—ã</button>
              </div>
              <label for="jsonArea">JSON</label>
              <textarea id="jsonArea" placeholder="–ù–∞–∂–º–∏ ¬´–≠–∫—Å–ø–æ—Ä—Ç¬ª –∏–ª–∏ –≤—Å—Ç–∞–≤—å JSON –∏ –Ω–∞–∂–º–∏ ¬´–ò–º–ø–æ—Ä—Ç¬ª"></textarea>
            </div>
          </details>

          </div>
      </aside>

      <main class="card">
        <div class="hdr">
          <h2>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞</h2>
          
        </div>
        <div class="cardPad">
          <div class="workTitle">
            <h3 id="workTitle">‚Äî</h3>
</div>
          <div class="note" id="workNote" style="margin-top:6px"></div>
          <div id="workout"></div>
        </div>
      </main>
    </div>
  </div>

<script>

  // Safe storage wrapper (iOS private mode / quota can throw)
  const storage = (() => {
    let mem = {};
    function get(k){ try{ const v = storage.get(k); return v === null ? null : v; }catch{ return (k in mem) ? mem[k] : null; } }
    function set(k,v){ try{ storage.set(k,v); }catch{ mem[k]=String(v); } }
    function del(k){ try{ storage.del(k); }catch{ delete mem[k]; } }
    return { get, set, del };
  })();

  function catRain(n=14){
    try{
      let layer = document.getElementById("catRainLayer");
      if(!layer){
        layer = document.createElement("div");
        layer.id = "catRainLayer";
        layer.className = "catRain";
        document.body.appendChild(layer);
      }
      const W = window.innerWidth || 360;
      const emojis = ["üê±","üò∫","üò∏","üòª","üêæ"];
      const max = Math.min(28, Math.max(6, n));
      for(let i=0;i<max;i++){
        const d = document.createElement("div");
        d.className = "catDrop";
        d.textContent = emojis[(Math.random()*emojis.length)|0];
        const left = Math.round(Math.random()*(W-24));
        const dur = 1200 + Math.random()*1100;
        const delay = Math.random()*220;
        const rot = Math.round((Math.random()*80)-40) + "deg";
        d.style.left = left + "px";
        d.style.setProperty("--dur", dur + "ms");
        d.style.animationDelay = delay + "ms";
        d.style.setProperty("--rot", rot);
        layer.appendChild(d);
        d.addEventListener("animationend", ()=>d.remove(), {once:true});
      }
      clearTimeout(catRain._tm);
      catRain._tm = setTimeout(()=>{
        const lay = document.getElementById("catRainLayer");
        if(lay && lay.childElementCount===0) lay.remove();
      }, 2600);
    }catch(e){}
  }

  function toast(msg){
    let t = document.getElementById("catToast");
    if(!t){
      t = document.createElement("div");
      t.id = "catToast";
      t.className = "catToast";
      document.body.appendChild(t);
    }
    t.textContent = msg;
    t.classList.add("show");
    clearTimeout(toast._tm);
    toast._tm = setTimeout(()=>t.classList.remove("show"), 1400);
  }

  // Cat (minimal)
  const EGG = { key: "egg::cats::v1" };
  const CAT = {
    key: "catmode::v2",
    enabled: true,
    msgs: ["–ú—è—É üêæ", "–•–æ—Ä–æ—à–æ –∏–¥—ë—à—å üòº", "–¢–µ—Ö–Ω–∏–∫–∞! üò∫", "–ï—â—ë –æ–¥–∏–Ω –ø–æ–¥—Ö–æ–¥ üòæ", "–ì–æ—Ç–æ–≤–æ üò∏"]
  };

  const EX = {
    "01-01":"–ü–æ–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–≥–∏–±–∞–Ω–∏—è —Ä—É–∫ —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏",
    "01-02":"–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–≥–∏–±–∞–Ω–∏–µ –æ–¥–Ω–æ–π —Ä—É–∫–∏ —Å –≥–∞–Ω—Ç–µ–ª—å—é",
    "01-03":"–°–≥–∏–±–∞–Ω–∏–µ —Ä—É–∫ —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏ —Ö–≤–∞—Ç–æ–º ¬´–º–æ–ª–æ—Ç–æ–∫¬ª",
    "01-04":"–°–≥–∏–±–∞–Ω–∏–µ –æ–¥–Ω–æ–π —Ä—É–∫–∏ —Å —Ä—É–∫–æ—è—Ç–∫–æ–π –Ω–∏–∂–Ω–µ–≥–æ –±–ª–æ–∫–∞",
    "01-05":"–°–≥–∏–±–∞–Ω–∏–µ —Ä—É–∫ —Å —Ä—É–∫–æ—è—Ç–∫–∞–º–∏ –≤–µ—Ä—Ö–Ω–∏—Ö –±–ª–æ–∫–æ–≤",
    "01-06":"–°–≥–∏–±–∞–Ω–∏–µ —Ä—É–∫ —Å –≥—Ä–∏—Ñ–æ–º —à—Ç–∞–Ω–≥–∏",
    "01-07":"–°–≥–∏–±–∞–Ω–∏–µ —Ä—É–∫ –Ω–∞ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ ¬´Larry-Scott¬ª",
    "01-08":"–°–≥–∏–±–∞–Ω–∏–µ —Ä—É–∫ –Ω–∞ —Å–∫–∞–º—å–µ ¬´Larry-Scott¬ª",
    "01-09":"–°–≥–∏–±–∞–Ω–∏–µ —Ä—É–∫ —Å–æ —à—Ç–∞–Ω–≥–æ–π —Ö–≤–∞—Ç–æ–º —Å–≤–µ—Ä—Ö—É",
    "01-10":"–†–∞–∑–≥–∏–±–∞–Ω–∏–µ –∑–∞–ø—è—Å—Ç–∏–π —Å–æ —à—Ç–∞–Ω–≥–æ–π —Ö–≤–∞—Ç–æ–º —Å–≤–µ—Ä—Ö—É",
    "01-11":"–°–≥–∏–±–∞–Ω–∏–µ –∑–∞–ø—è—Å—Ç–∏–π —Å–æ —à—Ç–∞–Ω–≥–æ–π —Ö–≤–∞—Ç–æ–º —Å–Ω–∏–∑—É",
    "01-12":"–†–∞–∑–≥–∏–±–∞–Ω–∏–µ —Ä—É–∫ —Å —Ä—É–∫–æ—è—Ç–∫–æ–π –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞ —Ö–≤–∞—Ç–æ–º —Å–≤–µ—Ä—Ö—É",
    "01-13":"–†–∞–∑–≥–∏–±–∞–Ω–∏–µ —Ä—É–∫ —Å —Ä—É–∫–æ—è—Ç–∫–æ–π –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞ —Ö–≤–∞—Ç–æ–º —Å–Ω–∏–∑—É",
    "01-14":"–†–∞–∑–≥–∏–±–∞–Ω–∏–µ –æ–¥–Ω–æ–π —Ä—É–∫–∏ —Å –≤–µ—Ä—Ö–Ω–∏–º –±–ª–æ–∫–æ–º —Ö–≤–∞—Ç–æ–º —Å–Ω–∏–∑—É",
    "01-15":"–†–∞–∑–≥–∏–±–∞–Ω–∏–µ —Ä—É–∫ —Å–æ —à—Ç–∞–Ω–≥–æ–π –ª—ë–∂–∞",
    "01-16":"–†–∞–∑–≥–∏–±–∞–Ω–∏–µ —Ä—É–∫ —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏ –ª—ë–∂–∞",
    "01-17":"–†–∞–∑–≥–∏–±–∞–Ω–∏–µ –æ–¥–Ω–æ–π —Ä—É–∫–∏ —Å –≥–∞–Ω—Ç–µ–ª—å—é –∏–∑-–∑–∞ –≥–æ–ª–æ–≤—ã",
    "01-18":"–†–∞–∑–≥–∏–±–∞–Ω–∏–µ —Ä—É–∫ —Å –æ–¥–Ω–æ–π –≥–∞–Ω—Ç–µ–ª—å—é –∏–∑-–∑–∞ –≥–æ–ª–æ–≤—ã",
    "01-19":"–†–∞–∑–≥–∏–±–∞–Ω–∏–µ —Ä—É–∫ —Å –∏–∑–æ–≥–Ω—É—Ç—ã–º –≥—Ä–∏—Ñ–æ–º —à—Ç–∞–Ω–≥–∏ –∏–∑-–∑–∞ –≥–æ–ª–æ–≤—ã",
    "01-20":"–†–∞–∑–≥–∏–±–∞–Ω–∏–µ –æ–¥–Ω–æ–π —Ä—É–∫–∏ –Ω–∞–∑–∞–¥ —Å –≥–∞–Ω—Ç–µ–ª—å—é –≤ –Ω–∞–∫–ª–æ–Ω–µ",
    "01-21":"–û—Ç–∂–∏–º–∞–Ω–∏—è —Ç—Ä–∏—Ü–µ–ø—Å–∞–º–∏ —Å–ø–∏–Ω–æ–π –∫ —Å–∫–∞–º—å–µ",
    "02-01":"–ñ–∏–º —à—Ç–∞–Ω–≥–∏ –∏–∑-–∑–∞ –≥–æ–ª–æ–≤—ã —Å–∏–¥—è",
    "02-02":"–ñ–∏–º —à—Ç–∞–Ω–≥–∏ —Å –≥—Ä—É–¥–∏ —Å–∏–¥—è",
    "02-03":"–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π —Å–∏–¥—è",
    "02-04":"–ü–æ–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–π –∂–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π —Å –ø–æ–≤–æ—Ä–æ—Ç–∞–º–∏ –∑–∞–ø—è—Å—Ç–∏–π",
    "02-05":"–ü–æ–¥—ä—ë–º—ã –≥–∞–Ω—Ç–µ–ª–µ–π –≤ —Å—Ç–æ—Ä–æ–Ω—ã –≤ –Ω–∞–∫–ª–æ–Ω–µ –≤–ø–µ—Ä—ë–¥",
    "02-06":"–ü–æ–¥—ä—ë–º—ã –≥–∞–Ω—Ç–µ–ª–µ–π –≤ —Å—Ç–æ—Ä–æ–Ω—ã",
    "02-07":"–ü–æ–¥—ä—ë–º—ã –≥–∞–Ω—Ç–µ–ª–µ–π –≤–ø–µ—Ä—ë–¥ –ø–æ–ø–µ—Ä–µ–º–µ–Ω–Ω–æ",
    "02-08":"–ü–æ–¥—ä—ë–º –≥–∞–Ω—Ç–µ–ª–∏ –≤ —Å—Ç–æ—Ä–æ–Ω—É –æ–¥–Ω–æ–π —Ä—É–∫–æ–π, –ª—ë–∂–∞ –Ω–∞ –±–æ–∫—É",
    "02-09":"–ü–æ–¥—ä—ë–º –æ–¥–Ω–æ–π —Ä—É–∫–∏ –≤ —Å—Ç–æ—Ä–æ–Ω—É —Å –Ω–∏–∂–Ω–µ–≥–æ –±–ª–æ–∫–∞",
    "02-10":"–ü–æ–¥—ä—ë–º –æ–¥–Ω–æ–π —Ä—É–∫–∏ –≤–ø–µ—Ä—ë–¥ —Å –Ω–∏–∂–Ω–µ–≥–æ –±–ª–æ–∫–∞ —Å—Ç–æ—è",
    "02-11":"–ü–µ—Ä–µ–∫—Ä—ë—Å—Ç–Ω—ã–µ –º–∞—Ö–∏ —Ä—É–∫–∞–º–∏ –Ω–∞–∑–∞–¥ —Å –≤–µ—Ä—Ö–Ω–∏—Ö –±–ª–æ–∫–æ–≤",
    "02-12":"–ü–µ—Ä–µ–∫—Ä—ë—Å—Ç–Ω—ã–µ –º–∞—Ö–∏ —Ä—É–∫–∞–º–∏ –Ω–∞–∑–∞–¥ —Å –Ω–∏–∂–Ω–∏—Ö –±–ª–æ–∫–æ–≤ –≤ –Ω–∞–∫–ª–æ–Ω–µ",
    "02-13":"–ü–æ–¥—ä—ë–º—ã —Ä—É–∫ –≤–ø–µ—Ä—ë–¥ —Å –æ–¥–Ω–æ–π –≥–∞–Ω—Ç–µ–ª—å—é",
    "02-14":"–ü–æ–¥—ä—ë–º—ã —à—Ç–∞–Ω–≥–∏ –≤–ø–µ—Ä—ë–¥",
    "02-15":"–ü–ª–µ—á–µ–≤–∞—è –ø–µ—Ä–µ–¥–Ω—è—è –ø—Ä–æ—Ç—è–∂–∫–∞",
    "02-16":"–ü–æ–¥—ä—ë–º—ã —Ä—É–∫ –≤ —Å—Ç–æ—Ä–æ–Ω—ã –Ω–∞ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ",
    "02-17":"–ú–∞—Ö–∏ —Ä—É–∫–∞–º–∏ –Ω–∞–∑–∞–¥ —Å —Ä—É–∫–æ—è—Ç–∫–∞–º–∏ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–∞",
    "03-01":"–ñ–∏–º —à—Ç–∞–Ω–≥–∏, –ª—ë–∂–∞ –Ω–∞ –Ω–∞–∫–ª–æ–Ω–Ω–æ–π —Å–∫–∞–º—å–µ",
    "03-02":"–ñ–∏–º —à—Ç–∞–Ω–≥–∏, –ª—ë–∂–∞ –Ω–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–π —Å–∫–∞–º—å–µ",
    "03-03":"–ñ–∏–º —à—Ç–∞–Ω–≥–∏ —É–∑–∫–∏–º —Ö–≤–∞—Ç–æ–º, –ª—ë–∂–∞ –Ω–∞ —Å–∫–∞–º—å–µ",
    "03-04":"–ñ–∏–º —à—Ç–∞–Ω–≥–∏, –ª—ë–∂–∞ –Ω–∞ —Å–∫–∞–º—å–µ —Å —É–∫–ª–æ–Ω–æ–º",
    "03-05":"–û—Ç–∂–∏–º–∞–Ω–∏—è –æ—Ç –ø–æ–ª–∞",
    "03-06":"–û—Ç–∂–∏–º–∞–Ω–∏—è –Ω–∞ –±—Ä—É—Å—å—è—Ö",
    "03-07":"–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –ª—ë–∂–∞",
    "03-08":"–†–∞–∑–≤–µ–¥–µ–Ω–∏–µ –≥–∞–Ω—Ç–µ–ª–µ–π –ª—ë–∂–∞",
    "03-09":"–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π, –ª—ë–∂–∞ –Ω–∞ –Ω–∞–∫–ª–æ–Ω–Ω–æ–π —Å–∫–∞–º—å–µ",
    "03-10":"–†–∞–∑–≤–µ–¥–µ–Ω–∏–µ –≥–∞–Ω—Ç–µ–ª–µ–π, –ª—ë–∂–∞ –Ω–∞ –Ω–∞–∫–ª–æ–Ω–Ω–æ–π —Å–∫–∞–º—å–µ",
    "03-11":"–°–≤–µ–¥–µ–Ω–∏–µ —Ä—É–∫ –Ω–∞ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ",
    "03-12":"–°–≤–µ–¥–µ–Ω–∏–µ –≤–µ—Ä—Ö–Ω–∏—Ö –±–ª–æ–∫–æ–≤ ¬´cross-over¬ª",
    "03-13":"–¢—è–≥–∞ –≥–∞–Ω—Ç–µ–ª–∏ –∏–∑-–∑–∞ –≥–æ–ª–æ–≤—ã –ª—ë–∂–∞ ¬´pull-over¬ª",
    "03-14":"–¢—è–≥–∞ —à—Ç–∞–Ω–≥–∏ –ª—ë–∂–∞ ¬´pull-over¬ª",
    "04-01":"–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è –Ω–∞ –ø–µ—Ä–µ–∫–ª–∞–¥–∏–Ω–µ —Ö–≤–∞—Ç–æ–º —Å–Ω–∏–∑—É",
    "04-02":"–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è –Ω–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–∫–ª–∞–¥–∏–Ω–µ",
    "04-03":"–¢—è–≥–∏ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞ –ø–µ—Ä–µ–¥ —Å–æ–±–æ–π",
    "04-04":"–¢—è–≥–∏ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞ –∑–∞ —à–µ—é",
    "04-05":"–¢—è–≥–∏ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞ —É–∑–∫–∏–º —Ö–≤–∞—Ç–æ–º",
    "04-06":"–¢—è–≥–∏ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞ –ø—Ä—è–º—ã–º–∏ —Ä—É–∫–∞–º–∏",
    "04-07":"–¢—è–≥–∏ –Ω–∏–∂–Ω–µ–≥–æ –±–ª–æ–∫–∞ (–≥—Ä–µ–±–ª—è)",
    "04-08":"–¢—è–≥–∏ –≥–∞–Ω—Ç–µ–ª–∏ –æ–¥–Ω–æ–π —Ä—É–∫–æ–π",
    "04-09":"–¢—è–≥–∏ —à—Ç–∞–Ω–≥–∏, —Å—Ç–æ—è –≤ –Ω–∞–∫–ª–æ–Ω–µ",
    "04-10":"–¢—è–≥–∏ –¢-–æ–±—Ä–∞–∑–Ω–æ–≥–æ –≥—Ä–∏—Ñ–∞ (–≥—Ä–µ–±–ª—è)",
    "04-11":"–¢—è–≥–∏ –¢-–æ–±—Ä–∞–∑–Ω–æ–≥–æ –≥—Ä–∏—Ñ–∞ (–≥—Ä–µ–±–ª—è) —Å —É–ø–æ—Ä–æ–º",
    "04-12":"¬´–ú—ë—Ä—Ç–≤—ã–µ¬ª —Ç—è–≥–∏ —Å–æ —à—Ç–∞–Ω–≥–æ–π, –Ω–æ–≥–∏ –ø—Ä—è–º—ã–µ",
    "04-13":"¬´–ú—ë—Ä—Ç–≤—ã–µ¬ª —Ç—è–≥–∏ –≤ —Å—Ç–∏–ª–µ —Å—É–º–æ",
    "04-14":"–°—Ç–∞–Ω–æ–≤—ã–µ —Ç—è–≥–∏ —Å–æ —à—Ç–∞–Ω–≥–æ–π",
    "04-15":"–ü–æ—è—Å–Ω–∏—á–Ω—ã–µ –ø—Ä–æ–≥–∏–±–∞–Ω–∏—è",
    "04-16":"–†–∞–∑–≥–∏–±–∞–Ω–∏—è —Ç—É–ª–æ–≤–∏—â–∞ –Ω–∞ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ",
    "04-17":"–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ —Ç—è–≥–∏",
    "04-18":"–®—Ä–∞–≥–∏ —Å–æ —à—Ç–∞–Ω–≥–æ–π",
    "04-19":"–®—Ä–∞–≥–∏ —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏",
    "04-20":"–®—Ä–∞–≥–∏ –Ω–∞ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ",
    "05-01":"–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏",
    "05-02":"–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è —Å–æ —à—Ç–∞–Ω–≥–æ–π –Ω–∞ –≥—Ä—É–¥–∏",
    "05-03":"–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è —Å–æ —à—Ç–∞–Ω–≥–æ–π –Ω–∞ –ø–ª–µ—á–∞—Ö",
    "05-04":"–®–∏—Ä–æ–∫–∏–µ –ø—Ä–∏—Å–µ–¥–∞–Ω–∏—è",
    "05-05":"–ù–∞–∫–ª–æ–Ω–Ω—ã–π –∂–∏–º –Ω–æ–≥–∞–º–∏",
    "05-06":"–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è –Ω–∞ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ ¬´Hack squat¬ª",
    "05-07":"–†–∞–∑–≥–∏–±–∞–Ω–∏–µ –Ω–æ–≥",
    "05-08":"–°–≥–∏–±–∞–Ω–∏–µ –Ω–æ–≥ –ª—ë–∂–∞",
    "05-09":"–°–≥–∏–±–∞–Ω–∏–µ –æ–¥–Ω–æ–π –Ω–æ–≥–∏ —Å—Ç–æ—è",
    "05-10":"–°–≥–∏–±–∞–Ω–∏–µ –Ω–æ–≥ —Å–∏–¥—è",
    "05-11":"–ü–æ–¥—ä—ë–º—ã —Ç–æ—Ä—Å–∞ ¬´—Å –¥–æ–±—Ä—ã–º —É—Ç—Ä–æ–º¬ª",
    "05-12":"–ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –æ–¥–Ω–æ–π –Ω–æ–≥–∏ —Å—Ç–æ—è",
    "05-13":"–°–≤–µ–¥–µ–Ω–∏–µ –Ω–æ–≥ —Å–∏–¥—è",
    "05-14":"–ü–æ–¥—ä—ë–º—ã –Ω–∞ –Ω–æ—Å–∫–∏ —Å—Ç–æ—è",
    "05-15":"–ü–æ–¥—ä—ë–º –Ω–∞ –Ω–æ—Å–æ–∫ –æ–¥–Ω–æ–π –Ω–æ–≥–∏ —Å—Ç–æ—è",
    "05-16":"–ü–æ–¥—ä—ë–º—ã –Ω–∞ –Ω–æ—Å–∫–∏ –≤ –Ω–∞–∫–ª–æ–Ω–µ ¬´–æ—Å–ª–∏–∫¬ª",
    "05-17":"–†–∞–∑–≥–∏–±–∞–Ω–∏–µ –≥–æ–ª–µ–Ω–∏ —Å–∏–¥—è",
    "05-18":"–†–∞–∑–≥–∏–±–∞–Ω–∏–µ –≥–æ–ª–µ–Ω–∏ —Å–∏–¥—è, —Å–æ —à—Ç–∞–Ω–≥–æ–π –Ω–∞ –∫–æ–ª–µ–Ω—è—Ö",
    "06-01":"–í—ã–ø–∞–¥—ã —Å–æ —à—Ç–∞–Ω–≥–æ–π –Ω–∞ –ø–ª–µ—á–∞—Ö",
    "06-02":"–í—ã–ø–∞–¥—ã —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏",
    "06-03":"–ú–∞—Ö–∏ –Ω–æ–≥–æ–π –Ω–∞–∑–∞–¥ —Å –Ω–∏–∂–Ω–µ–≥–æ –±–ª–æ–∫–∞",
    "06-04":"–ú–∞—Ö–∏ –Ω–æ–≥–æ–π –Ω–∞–∑–∞–¥ —Å —Ä—ã—á–∞–≥–æ–º —Ç—Ä–µ–Ω–∞–∂—ë—Ä–∞",
    "06-05":"–ú–∞—Ö–∏ –Ω–æ–≥–æ–π –Ω–∞–∑–∞–¥ –Ω–∞ –ø–æ–ª—É",
    "06-06":"¬´–ú–æ—Å—Ç–∏–∫¬ª –ª—ë–∂–∞",
    "06-07":"–ú–∞—Ö–∏ –Ω–æ–≥–æ–π –≤ —Å—Ç–æ—Ä–æ–Ω—É —Å –Ω–∏–∂–Ω–µ–≥–æ –±–ª–æ–∫–∞",
    "06-08":"–ú–∞—Ö–∏ –Ω–æ–≥–æ–π –≤ —Å—Ç–æ—Ä–æ–Ω—É —Å —Ä—ã—á–∞–≥–æ–º —Ç—Ä–µ–Ω–∞–∂—ë—Ä–∞",
    "06-09":"–ú–∞—Ö–∏ –Ω–æ–≥–æ–π –≤ —Å—Ç–æ—Ä–æ–Ω—É, –ª—ë–∂–∞ –Ω–∞ –±–æ–∫—É",
    "06-10":"–†–∞–∑–≤–µ–¥–µ–Ω–∏–µ –Ω–æ–≥ –Ω–∞ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ",
    "07-01":"–°–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ —Ç—É–ª–æ–≤–∏—â–∞ –Ω–∞ –ø–æ–ª—É",
    "07-02":"–ü–æ–¥—ä—ë–º—ã —Ç—É–ª–æ–≤–∏—â–∞",
    "07-03":"–ü–æ–¥—ä—ë–º—ã —Ç—É–ª–æ–≤–∏—â–∞ —É –≥–∏–º–Ω–∞—Å—Ç–∏—á–µ—Å–∫–æ–π —Å—Ç–µ–Ω–∫–∏",
    "07-04":"–°–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ —Ç—É–ª–æ–≤–∏—â–∞ —Å –≥–æ–ª–µ–Ω—å—é –Ω–∞ —Å–∫–∞–º—å–µ",
    "07-05":"–ü–æ–¥—ä—ë–º—ã —Ç—É–ª–æ–≤–∏—â–∞ –Ω–∞ –Ω–∞–∫–ª–æ–Ω–Ω–æ–π —Å–∫–∞–º—å–µ",
    "07-06":"–ü–æ–¥—ä—ë–º—ã —Ç—É–ª–æ–≤–∏—â–∞ –Ω–∞ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π —Å–∫–∞–º—å–µ",
    "07-07":"–°–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ —Ç—É–ª–æ–≤–∏—â–∞ —Å –≤–µ—Ä—Ö–Ω–∏–º –±–ª–æ–∫–æ–º",
    "07-08":"–°–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ —Ç—É–ª–æ–≤–∏—â–∞ –Ω–∞ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ",
    "07-09":"–ü–æ–¥—ä—ë–º—ã –Ω–æ–≥ –Ω–∞ –Ω–∞–∫–ª–æ–Ω–Ω–æ–π —Å–∫–∞–º—å–µ",
    "07-10":"–ü–æ–¥—ä—ë–º—ã –∫–æ–ª–µ–Ω–µ–π –≤ —É–ø–æ—Ä–µ",
    "07-11":"–ü–æ–¥—ä—ë–º—ã –∫–æ–ª–µ–Ω–µ–π –≤ –≤–∏—Å–µ",
    "07-12":"–†–∞–∑–≤–æ—Ä–æ—Ç—ã —Ç—É–ª–æ–≤–∏—â–∞ —Å –≥—Ä–∏—Ñ–æ–º",
    "07-13":"–ë–æ–∫–æ–≤—ã–µ –Ω–∞–∫–ª–æ–Ω—ã —Ç—É–ª–æ–≤–∏—â–∞ —Å—Ç–æ—è",
    "07-14":"–ë–æ–∫–æ–≤—ã–µ –ø–æ–¥—ä—ë–º—ã —Ç—É–ª–æ–≤–∏—â–∞ –Ω–∞ —Ä–∏–º—Å–∫–æ–º —Å—Ç—É–ª–µ",
    "07-15":"–í—Ä–∞—â–µ–Ω–∏—è —Ç—É–ª–æ–≤–∏—â–∞ —Å—Ç–æ—è –Ω–∞ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ ¬´—Ç–≤–∏—Å—Ç¬ª"
  };

  const DEFAULT_PROGRAMS = {
    "legs_strength": { group:"–ë–∞–∑–∞ / —Å–∏–ª–∞", name:"–ù–æ–≥–∏ ‚Äî —Å–∏–ª–∞ (–ø—Ä–∏—Å–µ–¥)", note:"–¢—è–∂—ë–ª–∞—è –±–∞–∑–∞. –î–µ—Ä–∂–∏ —Ç–µ—Ö–Ω–∏–∫—É, –æ—Ç–¥—ã—Ö 2‚Äì3 –º–∏–Ω –Ω–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö.", items:[
      {id:"05-03", sets:5, reps:"3‚Äì6"},
      {id:"05-05", sets:4, reps:"6‚Äì10"},
      {id:"05-08", sets:4, reps:"8‚Äì12"},
      {id:"05-14", sets:5, reps:"8‚Äì12"},
    ]},
    "pull_strength": { group:"–ë–∞–∑–∞ / —Å–∏–ª–∞", name:"–°–ø–∏–Ω–∞ ‚Äî —Å–∏–ª–∞ (—Ç—è–≥–∏/–ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è)", note:"–û—Å–Ω–æ–≤–Ω–æ–π –∞–∫—Ü–µ–Ω—Ç: –ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è –∏ —Ç—è–≥–∞ –≤ –Ω–∞–∫–ª–æ–Ω–µ.", items:[
      {id:"04-01", sets:5, reps:"4‚Äì8"},
      {id:"04-09", sets:5, reps:"4‚Äì8"},
      {id:"04-07", sets:4, reps:"8‚Äì12"},
      {id:"04-18", sets:4, reps:"10‚Äì15"},
    ]},
    "push_strength": { group:"–ë–∞–∑–∞ / —Å–∏–ª–∞", name:"–ì—Ä—É–¥—å ‚Äî —Å–∏–ª–∞ (–∂–∏–º)", note:"–¢—è–∂—ë–ª—ã–π –∂–∏–º + –ø–ª–µ—á–∏. –û—Ç–¥—ã—Ö 2‚Äì3 –º–∏–Ω –Ω–∞ –∂–∏–º–µ.", items:[
      {id:"03-02", sets:5, reps:"3‚Äì6"},
      {id:"03-07", sets:4, reps:"6‚Äì10"},
      {id:"02-02", sets:4, reps:"4‚Äì8"},
      {id:"01-15", sets:3, reps:"6‚Äì10"},
    ]},

    "legs_hypertrophy": { group:"–ú–∞—Å—Å–∞ / –≥–∏–ø–µ—Ä—Ç—Ä–æ—Ñ–∏—è", name:"–ù–æ–≥–∏ ‚Äî –º–∞—Å—Å–∞ (–∫–≤–∞–¥—Ä—ã+–±–∏—Ü–µ–ø—Å –±–µ–¥—Ä–∞)", note:"–°—Ä–µ–¥–Ω–∏–µ –≤–µ—Å–∞, –º–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ–≤—Ç–æ—Ä–æ–≤.", items:[
      {id:"05-05", sets:4, reps:"8‚Äì12"},
      {id:"05-07", sets:4, reps:"12‚Äì15"},
      {id:"05-08", sets:4, reps:"10‚Äì15"},
      {id:"05-04", sets:3, reps:"8‚Äì12"},
      {id:"05-14", sets:4, reps:"12‚Äì20"},
    ]},
    "push_hypertrophy": { group:"–ú–∞—Å—Å–∞ / –≥–∏–ø–µ—Ä—Ç—Ä–æ—Ñ–∏—è", name:"Push ‚Äî –º–∞—Å—Å–∞ (–≥—Ä—É–¥—å+–ø–ª–µ—á–∏+—Ç—Ä–∏—Ü–µ–ø—Å)", note:"–ñ–∏–º—ã ‚Üí —Ä–∞–∑–≤–µ–¥–µ–Ω–∏—è ‚Üí –ø–ª–µ—á–∏ ‚Üí —Ç—Ä–∏—Ü–µ–ø—Å.", items:[
      {id:"03-02", sets:4, reps:"6‚Äì10"},
      {id:"03-08", sets:4, reps:"10‚Äì15"},
      {id:"02-06", sets:4, reps:"12‚Äì20"},
      {id:"02-03", sets:3, reps:"8‚Äì12"},
      {id:"01-12", sets:3, reps:"10‚Äì15"},
    ]},
    "pull_hypertrophy": { group:"–ú–∞—Å—Å–∞ / –≥–∏–ø–µ—Ä—Ç—Ä–æ—Ñ–∏—è", name:"Pull ‚Äî –º–∞—Å—Å–∞ (—Å–ø–∏–Ω–∞+–±–∏—Ü–µ–ø—Å)", note:"–ë–æ–ª—å—à–µ –æ–±—ä—ë–º–∞ –Ω–∞ —à–∏—Ä–æ—á–∞–π—à–∏–µ –∏ –±–∏—Ü–µ–ø—Å.", items:[
      {id:"04-03", sets:4, reps:"8‚Äì12"},
      {id:"04-07", sets:4, reps:"8‚Äì12"},
      {id:"04-08", sets:3, reps:"10‚Äì12"},
      {id:"01-06", sets:4, reps:"8‚Äì12"},
      {id:"01-03", sets:3, reps:"10‚Äì12"},
    ]},

    "shoulders_focus": { group:"–ü–ª–µ—á–∏ / —Ä—É–∫–∏", name:"–ü–ª–µ—á–∏ ‚Äî –∞–∫—Ü–µ–Ω—Ç", note:"–°–Ω–∞—á–∞–ª–∞ –∂–∏–º, –ø–æ—Ç–æ–º –º–∞—Ö–∏ –≤ —Å—Ç–æ—Ä–æ–Ω—ã/–∑–∞–¥–Ω—è—è –¥–µ–ª—å—Ç–∞.", items:[
      {id:"02-03", sets:4, reps:"6‚Äì10"},
      {id:"02-06", sets:5, reps:"12‚Äì20"},
      {id:"02-05", sets:4, reps:"12‚Äì20"},
      {id:"02-15", sets:3, reps:"10‚Äì15"},
    ]},
    "arms_focus": { group:"–ü–ª–µ—á–∏ / —Ä—É–∫–∏", name:"–†—É–∫–∏ ‚Äî –±–∏—Ü–µ–ø—Å+—Ç—Ä–∏—Ü–µ–ø—Å", note:"–ö–æ—Ä–æ—Ç–∫–∞—è, –Ω–æ ¬´–ø–∞–º–ø–æ–≤–∞—è¬ª —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞.", items:[
      {id:"01-06", sets:4, reps:"8‚Äì12"},
      {id:"01-02", sets:3, reps:"10‚Äì12"},
      {id:"01-15", sets:4, reps:"8‚Äì12"},
      {id:"01-20", sets:3, reps:"12‚Äì15"},
    ]},

    "glutes_abs": { group:"–Ø–≥–æ–¥–∏—Ü—ã / –ø—Ä–µ—Å—Å", name:"–Ø–≥–æ–¥–∏—Ü—ã + –ø—Ä–µ—Å—Å", note:"–°—Ä–µ–¥–Ω—è—è –Ω–∞–≥—Ä—É–∑–∫–∞. –•–æ—Ä–æ—à–æ –∫–∞–∫ 4‚Äì6-—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –Ω–µ–¥–µ–ª–∏.", items:[
      {id:"06-01", sets:4, reps:"8‚Äì12/–Ω–æ–≥–∞"},
      {id:"06-06", sets:5, reps:"10‚Äì15"},
      {id:"06-03", sets:4, reps:"12‚Äì15/–Ω–æ–≥–∞"},
      {id:"07-02", sets:4, reps:"12‚Äì20"},
      {id:"07-09", sets:4, reps:"10‚Äì15"},
    ]},
    "abs_only": { group:"–Ø–≥–æ–¥–∏—Ü—ã / –ø—Ä–µ—Å—Å", name:"–ü—Ä–µ—Å—Å ‚Äî –∫–æ—Ä–æ—Ç–∫–æ", note:"–ï—Å–ª–∏ –Ω–∞–¥–æ –±—ã—Å—Ç—Ä–æ –¥–æ–±–∏—Ç—å –∫–æ—Ä –ø–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏.", items:[
      {id:"07-02", sets:4, reps:"12‚Äì25"},
      {id:"07-09", sets:4, reps:"10‚Äì20"},
      {id:"07-13", sets:3, reps:"12‚Äì20/—Å—Ç–æ—Ä–æ–Ω–∞"},
    ]},

    "fullbody_a": { group:"Full body", name:"Full body A", note:"–ë–∞–∑–∞ –ø–æ –≤—Å–µ–º—É —Ç–µ–ª—É. –ù–µ –¥–æ–≤–æ–¥–∏ –∫–∞–∂–¥—ã–π –ø–æ–¥—Ö–æ–¥ –¥–æ –æ—Ç–∫–∞–∑–∞.", items:[
      {id:"05-03", sets:4, reps:"5‚Äì8"},
      {id:"03-02", sets:4, reps:"6‚Äì10"},
      {id:"04-01", sets:4, reps:"6‚Äì12"},
      {id:"02-06", sets:3, reps:"12‚Äì20"},
      {id:"07-02", sets:3, reps:"12‚Äì20"},
    ]},
    "fullbody_b": { group:"Full body", name:"Full body B", note:"–í–∞—Ä–∏–∞–Ω—Ç B: –±–æ–ª—å—à–µ —Ç—è–≥–∏/–Ω–æ–≥, –º–µ–Ω—å—à–µ –∂–∏–º–∞.", items:[
      {id:"05-05", sets:4, reps:"8‚Äì12"},
      {id:"04-07", sets:4, reps:"8‚Äì12"},
      {id:"03-09", sets:3, reps:"8‚Äì12"},
      {id:"01-06", sets:3, reps:"8‚Äì12"},
      {id:"07-09", sets:3, reps:"10‚Äì15"},
    ]},
  };

  const GROUP_ORDER = ["–ë–∞–∑–∞ / —Å–∏–ª–∞", "–ú–∞—Å—Å–∞ / –≥–∏–ø–µ—Ä—Ç—Ä–æ—Ñ–∏—è", "–ü–ª–µ—á–∏ / —Ä—É–∫–∏", "–Ø–≥–æ–¥–∏—Ü—ã / –ø—Ä–µ—Å—Å", "Full body", "–î—Ä—É–≥–æ–µ"];

  const TEMPLATES = {
    "4_hyp": { order:["push_hypertrophy","pull_hypertrophy","legs_hypertrophy","glutes_abs"] },
    "3_fb":  { order:["fullbody_a","fullbody_b","fullbody_a"] },
    "5_str": { order:["push_strength","pull_strength","legs_strength","shoulders_focus","arms_focus"] },
    "6_ppl": { order:["push_hypertrophy","pull_hypertrophy","legs_hypertrophy","push_strength","pull_strength","legs_strength"] },
  };

  const K = {
    programs: "programs::v2",
    state: (date, prog) => `state::${date}::${prog}`,
    history: "history::v2",
    cycle: (tpl) => `cycle::${tpl}`,
  };

  const $ = (id)=>document.getElementById(id);
  const elDate = $("date");
  const elTemplate = $("template");
  const elProgram = $("program");

  const elProgressBar = $("progressBar");
  const elProgressText = $("progressText");
  const elProgressSets = $("progressSets");
  const elTonnage = $("tonnage");
  const elExCount = $("exCount");

  const elWorkTitle = $("workTitle");
  const elWorkNote  = $("workNote");
  const elWorkout   = $("workout");

  const elHistory = $("history");
  const elSearch = $("search");
  const elSearchResults = $("searchResults");
  const elJsonArea = $("jsonArea");

  // Program sheet (mobile)
  const programBtn = document.getElementById("programBtn");
  const programSheet = document.getElementById("programSheet");
  const programList = document.getElementById("programList");
  const programSearch = document.getElementById("programSearch");

  function openSheet(){
    if(!programSheet) return;
    programSheet.setAttribute("aria-hidden","false");
    document.body.style.overflow = "hidden";
    setTimeout(()=>{ try{ programSearch && programSearch.focus(); }catch(e){} }, 50);
    renderProgramSheet();
  }
  function closeSheet(){
    if(!programSheet) return;
    programSheet.setAttribute("aria-hidden","true");
    document.body.style.overflow = "";
    if(programSearch) programSearch.value = "";
  }
  if(programSheet){
    programSheet.addEventListener("click", (e)=>{
      const t = e.target;
      if(t && t.getAttribute && t.getAttribute("data-close")==="1") closeSheet();
    });
    document.addEventListener("keydown",(e)=>{ if(e.key==="Escape") closeSheet(); });
  }
  if(programBtn){
    programBtn.addEventListener("click", openSheet);
  }
  if(programSearch){
    programSearch.addEventListener("input", ()=>renderProgramSheet());
  }

  function renderProgramSheet(){
    if(!programList) return;
    const q = (programSearch?.value || "").trim().toLowerCase();

    const groups = Array.from(new Set(Object.values(PROGRAMS).map(p=>p.group || "–î—Ä—É–≥–æ–µ")))
      .sort((a,b)=> groupOrderKey(a)-groupOrderKey(b) || a.localeCompare(b));

    programList.innerHTML = "";
    groups.forEach(g=>{
      const keys = Object.keys(PROGRAMS)
        .filter(k => (PROGRAMS[k].group || "–î—Ä—É–≥–æ–µ") === g)
        .sort((a,b)=> (PROGRAMS[a].name||a).localeCompare(PROGRAMS[b].name||b))
        .filter(k=>{
          if(!q) return true;
          const p = PROGRAMS[k];
          return (p.name||"").toLowerCase().includes(q) || k.toLowerCase().includes(q);
        });
      if(keys.length===0) return;

      const block = document.createElement("div");
      block.className = "sheetGroup";
      block.innerHTML = `<div class="sheetGroupTitle">${g}</div>`;
      keys.forEach(k=>{
        const p = PROGRAMS[k];
        const row = document.createElement("div");
        row.className = "sheetItem";
        row.innerHTML = `<div class="sheetName">${p.name || k}</div><div class="sheetCode">${k.toUpperCase()}</div>`;
        row.addEventListener("click", ()=>{
          elProgram.value = k;
          renderAll();
          closeSheet();
        });
        block.appendChild(row);
      });
      programList.appendChild(block);
    });
  }


  const elTimerText = $("timerText");
  const elTimerState = $("timerState");
  const btnStop = $("timerStop");

  function todayISO(){
    const d = new Date();
    const z = (n)=>String(n).padStart(2,"0");
    return `${d.getFullYear()}-${z(d.getMonth()+1)}-${z(d.getDate())}`;
  }
  function formatMMSS(sec){
    const m = Math.floor(sec/60);
    const s = sec%60;
    return `${String(m).padStart(2,"0")}:${String(s).padStart(2,"0")}`;
  }

  function loadPrograms(){
    const raw = storage.get(K.programs);
    if(!raw) return structuredClone(DEFAULT_PROGRAMS);
    try{
      const obj = JSON.parse(raw);
      if(!obj || typeof obj !== "object") return structuredClone(DEFAULT_PROGRAMS);
      return obj;
    }catch{
      return structuredClone(DEFAULT_PROGRAMS);
    }
  }
  function savePrograms(obj){ storage.set(K.programs, JSON.stringify(obj)); }

  function loadState(date, prog){
    const raw = storage.get(K.state(date, prog));
    if(!raw) return null;
    try{ return JSON.parse(raw); }catch{ return null; }
  }
  function saveState(date, prog, state){
    storage.set(K.state(date, prog), JSON.stringify(state));
  }
  function clearState(date, prog){
    storage.del(K.state(date, prog));
  }
  function ensureState(date, prog, PROGRAMS){
    const p = PROGRAMS[prog];
    const state = loadState(date, prog) || { date, prog, ex:{} };

    p.items.forEach(it=>{
      if(!state.ex[it.id]) state.ex[it.id] = { sets: [] };
      const arr = state.ex[it.id].sets;
      while(arr.length < it.sets) arr.push({ done:false, w:"", r:"" });
      if(arr.length > it.sets) arr.length = it.sets;
    });

    saveState(date, prog, state);
    return state;
  }

  function computeStats(PROGRAMS, date, prog){
    const p = PROGRAMS[prog];
    const state = loadState(date, prog) || { ex:{} };
    let total = 0, done = 0, ton = 0;

    p.items.forEach(it=>{
      total += it.sets;
      const sets = state.ex?.[it.id]?.sets || [];
      sets.forEach(s=>{
        if(s?.done) done++;
        const w = Number(String(s?.w ?? "").replace(",", "."));
        const r = Number(String(s?.r ?? "").replace(",", "."));
        if(s?.done && w>0 && r>0) ton += w*r;
      });
    });

    const pct = total ? Math.round((done/total)*100) : 0;
    return { total, done, pct, ton: Math.round(ton) };
  }

  function perExerciseDone(state, it){
    const sets = state.ex?.[it.id]?.sets || [];
    let d = 0;
    sets.forEach(s=>{ if(s?.done) d++; });
    return { d, t: it.sets };
  }

  function readHistory(){
    const raw = storage.get(K.history);
    if(!raw) return [];
    try{
      const arr = JSON.parse(raw);
      return Array.isArray(arr) ? arr : [];
    }catch{ return []; }
  }
  function writeHistory(arr){
    storage.set(K.history, JSON.stringify(arr.slice(0, 200)));
  }
  function addHistory(entry){
    const arr = readHistory();
    const key = `${entry.date}::${entry.prog}`;
    const filtered = arr.filter(x => `${x.date}::${x.prog}` !== key);
    filtered.unshift(entry);
    writeHistory(filtered);
  }

  function renderHistory(PROGRAMS){
    const arr = readHistory().slice(0,12);
    elHistory.innerHTML = "";
    if(arr.length === 0){
      elHistory.innerHTML = ``;
      return;
    }
    arr.forEach(x=>{
      const p = PROGRAMS[x.prog];
      const item = document.createElement("div");
      item.className = "historyItem";
      item.innerHTML = `
        <div class="historyTop">
          <div class="t">${x.date} ¬∑ ${p ? p.name : x.prog}</div>
          <div class="s">${x.done}/${x.total} ¬∑ ${x.pct}% ¬∑ ${x.ton}–∫–≥</div>
        </div>
        <div class="small" style="margin-top:6px">${p ? p.group : ""}</div>
        <div class="historyBtns">
          <button class="small" data-open="${x.date}::${x.prog}">–û—Ç–∫—Ä—ã—Ç—å</button>
          <button class="small" data-del="${x.date}::${x.prog}">–£–¥–∞–ª–∏—Ç—å</button>
        </div>
      `;
      elHistory.appendChild(item);
    });

    elHistory.querySelectorAll("[data-open]").forEach(b=>{
      b.addEventListener("click", ()=>{
        const [date, prog] = b.getAttribute("data-open").split("::");
        elDate.value = date;
        elProgram.value = prog;
        renderAll();
      });
    });
    elHistory.querySelectorAll("[data-del]").forEach(b=>{
      b.addEventListener("click", ()=>{
        const [date, prog] = b.getAttribute("data-del").split("::");
        writeHistory(readHistory().filter(x => !(x.date===date && x.prog===prog)));
        renderHistory(PROGRAMS);
      });
    });
  }

  function renderSearch(q){
    const s = (q||"").trim().toLowerCase();
    elSearchResults.innerHTML = "";
    if(!s){
      elSearchResults.innerHTML = ``;
      return;
    }
    const items = Object.entries(EX)
      .map(([id, title])=>({id, title}))
      .filter(x => x.id.toLowerCase().includes(s) || x.title.toLowerCase().includes(s))
      .sort((a,b)=>a.id.localeCompare(b.id))
      .slice(0, 25);

    if(items.length === 0){
      elSearchResults.innerHTML = `<div class="small" style="margin-top:10px">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.</div>`;
      return;
    }

    items.forEach(x=>{
      const row = document.createElement("div");
      row.className = "historyItem";
      row.style.marginTop = "10px";
      row.innerHTML = `
        <div class="historyTop">
          <div class="t"><span class="kbd">${x.id}</span> ${x.title}</div>
          <div class="s"></div>
        </div>
        <div class="small" style="margin-top:6px">–ù–∞–∂–º–∏ —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–º–µ—Ä</div>
      `;
      row.addEventListener("click", async ()=>{
        try{ await navigator.clipboard.writeText(x.id); }catch{}
        elSearch.value = x.id;
      });
      elSearchResults.appendChild(row);
    });
  }

  function groupOrderKey(g){
    const idx = GROUP_ORDER.indexOf(g);
    return idx === -1 ? 999 : idx;
  }

  function fillProgramSelect(PROGRAMS){
    elProgram.innerHTML = "";
    const groups = Array.from(new Set(Object.values(PROGRAMS).map(p=>p.group || "–î—Ä—É–≥–æ–µ")))
      .sort((a,b)=> groupOrderKey(a)-groupOrderKey(b) || a.localeCompare(b));

    groups.forEach(g=>{
      const og = document.createElement("optgroup");
      og.label = g;

      Object.keys(PROGRAMS)
        .filter(k => (PROGRAMS[k].group || "–î—Ä—É–≥–æ–µ") === g)
        .sort((a,b)=> (PROGRAMS[a].name||a).localeCompare(PROGRAMS[b].name||b))
        .forEach(k=>{
          const o = document.createElement("option");
          o.value = k;
          o.textContent = PROGRAMS[k].name || k;
          og.appendChild(o);
        });

      elProgram.appendChild(og);
    });
  }

  function getCycle(tpl){
    const raw = storage.get(K.cycle(tpl));
    const n = Number(raw);
    return Number.isFinite(n) ? n : 0;
  }
  function setCycle(tpl, idx){
    storage.set(K.cycle(tpl), String(idx));
  }
  function pickNextProgram(PROGRAMS){
    const tpl = elTemplate.value;
    const order = TEMPLATES[tpl]?.order || [];
    if(order.length === 0) return null;

    let idx = getCycle(tpl);
    idx = ((idx % order.length) + order.length) % order.length;
    let prog = order[idx];

    if(!PROGRAMS[prog]){
      prog = order.find(k => PROGRAMS[k]) || Object.keys(PROGRAMS)[0];
    }
    setCycle(tpl, (idx + 1) % order.length);
    return prog;
  }

  function renderWorkout(PROGRAMS){
    const date = elDate.value;
    const prog = elProgram.value;
    if(!date || !prog || !PROGRAMS[prog]) return;

    const p = PROGRAMS[prog];
    const state = ensureState(date, prog, PROGRAMS);
    elWorkTitle.textContent = p.name || prog;
    try{ if(programBtn) programBtn.textContent = p.name || prog; }catch(e){}
    elWorkNote.textContent = p.note || "";

    elExCount.textContent = String(p.items.length);
    elWorkout.innerHTML = "";

    p.items.forEach(it=>{
      const exTitle = EX[it.id] || "‚Äî";
      const {d,t} = perExerciseDone(state, it);

      const box = document.createElement("div");
      box.className = "ex";

      const head = document.createElement("div");
      head.className = "exHead";
      head.innerHTML = `
        <div>
          <div class="exName">${exTitle}</div>
          <div class="exMeta">
            <span class="tag">${it.id}</span>
            <span class="tag muted">${it.sets}√ó${it.reps}</span>
          </div>
        </div>
        <div class="exRight">
          <div class="exDone" data-exdone="${it.id}">${d}/${t} –ø–æ–¥—Ö–æ–¥–æ–≤</div>
        </div>
      `;

      const grid = document.createElement("div");
      grid.className = "setGrid";

      for(let i=0;i<it.sets;i++){
        const s0 = state.ex[it.id].sets[i] || {done:false,w:"",r:""};

        const row = document.createElement("div");
        row.className = "setRow";

        const cb = document.createElement("input");
        cb.type = "checkbox";
        cb.checked = !!s0.done;

        const label = document.createElement("div");
        label.className = "s";
        label.textContent = `–ü–æ–¥—Ö–æ–¥ ${i+1}`;

        const w = document.createElement("input");
        w.type = "text";
        w.className = "mini";
        w.placeholder = "–∫–≥";
        w.value = s0.w ?? "";

        const r = document.createElement("input");
        r.type = "text";
        r.className = "mini";
        r.placeholder = "–ø–æ–≤—Ç";
        r.value = s0.r ?? "";

        const commit = ()=>{
          const st = ensureState(date, prog, PROGRAMS);
          st.ex[it.id].sets[i] = { done: cb.checked, w: (w.value||"").trim(), r: (r.value||"").trim() };
          saveState(date, prog, st);
          renderSidebarStats(PROGRAMS);
          const {d,t} = perExerciseDone(st, it);
          const exDoneEl = box.querySelector(`[data-exdone="${it.id}"]`);
          if(exDoneEl) exDoneEl.textContent = `${d}/${t} –ø–æ–¥—Ö–æ–¥–æ–≤`;
        };

        row.addEventListener("click", (e)=>{
          if(e.target && e.target.tagName === "INPUT") return;
          cb.checked = !cb.checked;
          commit();
        });

        cb.addEventListener("click", (e)=>e.stopPropagation());
        w.addEventListener("click", (e)=>e.stopPropagation());
        r.addEventListener("click", (e)=>e.stopPropagation());
        cb.addEventListener("change", commit);
        w.addEventListener("input", commit);
        r.addEventListener("input", commit);

        row.appendChild(cb);
        row.appendChild(label);
        row.appendChild(w);
        row.appendChild(r);

        grid.appendChild(row);
      }

      box.appendChild(head);
      box.appendChild(grid);
      elWorkout.appendChild(box);
    });

    renderSidebarStats(PROGRAMS);
  }

  function renderSidebarStats(PROGRAMS){
    const date = elDate.value;
    const prog = elProgram.value;
    if(!date || !prog || !PROGRAMS[prog]) return;

    const stats = computeStats(PROGRAMS, date, prog);
    elProgressBar.style.width = stats.pct + "%";
    elProgressText.textContent = stats.pct + "%";
    elProgressSets.textContent = `${stats.done}/${stats.total} –ø–æ–¥—Ö–æ–¥–æ–≤`;
    elTonnage.textContent = `${stats.ton} –∫–≥`;
    try{ updateCatFace(stats.pct); }catch(e){}

    // Reward at 100%
    if(CAT.enabled && stats.total>0 && stats.done===stats.total){
      const key = `reward::${date}::${prog}`;
      if(storage.get(key) !== "1"){
        storage.set(key, "1");
        toast(CAT.msgs[Math.floor(Math.random()*CAT.msgs.length)]);
      }
    }
  }

  function makeNote(PROGRAMS, date, prog){
    const p = PROGRAMS[prog];
    const state = loadState(date, prog) || { ex:{} };
    const stats = computeStats(PROGRAMS, date, prog);

    const lines = [];
    lines.push(`–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞: ${p.name}`);
    lines.push(`–ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${p.group}`);
    lines.push(`–î–∞—Ç–∞: ${date}`);
    lines.push("");

    p.items.forEach(it=>{
      const title = EX[it.id] || "‚Äî";
      const sets = state.ex?.[it.id]?.sets || [];
      const done = sets.filter(s=>s?.done).length;
      const parts = sets.map((s, idx)=>{
        const mark = s?.done ? "‚úì" : "‚Ä¢";
        const ww = (s?.w||"").trim() || "‚Äî";
        const rr = (s?.r||"").trim() || "‚Äî";
        return `${mark}${idx+1}:${ww}x${rr}`;
      }).join("  ");

      lines.push(`${it.id} ‚Äî ${title} ‚Äî ${it.sets}√ó${it.reps} (—Å–¥–µ–ª–∞–Ω–æ: ${done}/${it.sets})`);
      lines.push(`   ${parts}`);
    });

    lines.push("");
    lines.push(`–ò—Ç–æ–≥–æ: ${stats.done}/${stats.total} –ø–æ–¥—Ö–æ–¥–æ–≤ ¬∑ ${stats.pct}% ¬∑ —Ç–æ–Ω–Ω–∞–∂ ${stats.ton} –∫–≥`);
    return lines.join("\n");
  }

  let PROGRAMS = loadPrograms();

  function renderAll(){
    if(!elDate.value) elDate.value = todayISO();
    fillProgramSelect(PROGRAMS);

    const chosen = elProgram.value;
    if(!(chosen && PROGRAMS[chosen])){
      const first = Object.keys(PROGRAMS)[0];
      if(first) elProgram.value = first;
    }

    try{ const p0 = PROGRAMS[elProgram.value]; if(programBtn && p0) programBtn.textContent = p0.name || elProgram.value; }catch(e){}
    renderWorkout(PROGRAMS);
    renderHistory(PROGRAMS);
    renderSearch(elSearch.value);
  }

  // Timer
  let timerInt = null;
  let timerLeft = 0;

  function timerStop(){
    if(timerInt) clearInterval(timerInt);
    timerInt = null;
    timerLeft = 0;
    elTimerText.textContent = "00:00";
    elTimerState.textContent = "‚Äî";
  }

  function timerStart(seconds){
    if(timerInt) clearInterval(timerInt);
    timerLeft = seconds;
    elTimerText.textContent = formatMMSS(timerLeft);
    elTimerState.textContent = `${seconds}s`;

    timerInt = setInterval(()=>{
      timerLeft = Math.max(0, timerLeft - 1);
      elTimerText.textContent = formatMMSS(timerLeft);
      if(timerLeft === 0){
        clearInterval(timerInt);
        timerInt = null;
        elTimerState.textContent = "–ì–æ—Ç–æ–≤–æ";
        try{ if(navigator.vibrate) navigator.vibrate([120,80,120]); }catch{}
        try{
          const ctx = new (window.AudioContext || window.webkitAudioContext)();
          try{ if(ctx.state === 'suspended') ctx.resume(); }catch(e){}
          const o = ctx.createOscillator();
          const g = ctx.createGain();
          o.type = "sine"; o.frequency.value = 880;
          o.connect(g); g.connect(ctx.destination);
          g.gain.setValueAtTime(0.001, ctx.currentTime);
          g.gain.exponentialRampToValueAtTime(0.12, ctx.currentTime + 0.02);
          g.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.22);
          o.start(); o.stop(ctx.currentTime + 0.25);
          setTimeout(()=>ctx.close(), 300);
        }catch{}
      }
    }, 1000);
  }

  // Events
  $("btnToday").addEventListener("click", ()=>{
    elDate.value = todayISO();
    const next = pickNextProgram(PROGRAMS);
    if(next) elProgram.value = next;
    renderAll();
  });

  $("btnSave").addEventListener("click", ()=>{
    const date = elDate.value;
    const prog = elProgram.value;
    if(!date || !prog || !PROGRAMS[prog]) return;
    const st = computeStats(PROGRAMS, date, prog);
    addHistory({ date, prog, total: st.total, done: st.done, pct: st.pct, ton: st.ton });
    renderHistory(PROGRAMS);
    if(CAT.enabled) toast('–í –∂—É—Ä–Ω–∞–ª üêæ');
    /*saved*/
  });

  $("btnReset").addEventListener("click", ()=>{
    const date = elDate.value;
    const prog = elProgram.value;
    if(!date || !prog) return;
    clearState(date, prog);
    renderAll();
  });

  $("btnCopy").addEventListener("click", async ()=>{
    const date = elDate.value;
    const prog = elProgram.value;
    if(!date || !prog || !PROGRAMS[prog]) return;
    const text = makeNote(PROGRAMS, date, prog);
    let ok=false; try{ await navigator.clipboard.writeText(text); ok=true; }catch(e){}
    if(!ok){
      try{
        const ta=document.createElement("textarea"); ta.value=text; ta.style.position="fixed"; ta.style.left="-9999px";
        document.body.appendChild(ta); ta.focus(); ta.select();
        ok=document.execCommand("copy"); ta.remove();
      }catch(e){}
    }
    toast(ok ? "–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ üê±" : "–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ");
    /*copied*/
  });

  elDate.addEventListener("change", ()=>renderAll());
  elProgram.addEventListener("change", ()=>renderAll());
  elSearch.addEventListener("input", ()=>renderSearch(elSearch.value));

  document.querySelectorAll("[data-t]").forEach(b=>{
    b.addEventListener("click", ()=>timerStart(Number(b.getAttribute("data-t"))));
  });
  btnStop.addEventListener("click", timerStop);

  $("btnExport").addEventListener("click", ()=>{
    elJsonArea.value = JSON.stringify(PROGRAMS, null, 2);
  });

  $("btnImport").addEventListener("click", ()=>{
    const raw = elJsonArea.value.trim();
    if(!raw){ /*no_json*/ return; }
    try{
      const obj = JSON.parse(raw);
      if(!obj || typeof obj !== "object"){ alert("JSON –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ–±—ä–µ–∫—Ç–æ–º."); return; }
      for(const v of Object.values(obj)){
        if(!v || typeof v !== "object") throw new Error("bad program");
        if(!Array.isArray(v.items)) throw new Error("bad items");
      }
      PROGRAMS = obj;
      savePrograms(PROGRAMS);
      renderAll();
      if(CAT.enabled) toast('–ò–º–ø–æ—Ä—Ç üê±');
    /*imported*/
    }catch(e){
      /*import_failed*/
    }
  });

  $("btnResetPrograms").addEventListener("click", ()=>{
    PROGRAMS = structuredClone(DEFAULT_PROGRAMS);
    savePrograms(PROGRAMS);
    renderAll();
    if(CAT.enabled) toast('–°–±—Ä–æ—Å üêæ');
    /*reset*/
  });

  function getCycle(tpl){
    const raw = storage.get(K.cycle(tpl));
    const n = Number(raw);
    return Number.isFinite(n) ? n : 0;
  }
  function setCycle(tpl, idx){
    storage.set(K.cycle(tpl), String(idx));
  }

  // Cat wiring (compact)
  const catFace = document.getElementById("catFace");
  const catToggleSmall = document.getElementById("catToggleSmall");

  try{
    const saved = storage.get(CAT.key);
    if(saved !== null) CAT.enabled = saved === "1";
  }catch(e){}

  function catSet(enabled){
    CAT.enabled = enabled;
    storage.set(CAT.key, enabled ? "1" : "0");
    if(catToggleSmall) catToggleSmall.style.opacity = enabled ? "1" : ".55";
  }
  if(catToggleSmall){
    catToggleSmall.addEventListener("click", ()=>{
      catSet(!CAT.enabled);
      toast(CAT.enabled ? "–ö–æ—Ç–∏–∫–∏: –≤–∫–ª üêæ" : "–ö–æ—Ç–∏–∫–∏: –≤—ã–∫–ª");
    });
    catToggleSmall.style.opacity = CAT.enabled ? "1" : ".55";
  }

  function updateCatFace(pct){
    if(!catFace) return;
    if(!CAT.enabled){ catFace.textContent = "üôÇ"; return; }
    if(pct >= 100) catFace.textContent = "üòπ";
    else if(pct >= 80) catFace.textContent = "üòª";
    else if(pct >= 30) catFace.textContent = "üòº";
    else catFace.textContent = "üò∫";
  }

  // Tap cat -> cats rain (only after egg unlocked)
  if(catFace){
    catFace.style.cursor = "pointer";
    catFace.addEventListener("click", ()=>{
      if(document.body.classList.contains("egg")){
        catRain(18);
        if(CAT.enabled) toast("–º—è—É! üê±");
      }else{
        // do nothing (it's an easter egg)
      }
    });
  }
// Init
  elDate.value = todayISO();
  renderAll();
</script>

  <div id="programSheet" class="sheet" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="sheetBackdrop" data-close="1"></div>
    <div class="sheetCard" role="document">
      <div class="sheetTop">
        <div class="sheetTitle">–í—ã–±–æ—Ä –ø—Ä–æ–≥—Ä–∞–º–º—ã</div>
        <button class="sheetClose" type="button" data-close="1" aria-label="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
      </div>
      <div class="sheetBody">
        <input id="programSearch" class="sheetSearch" type="text" inputmode="search" placeholder="–ü–æ–∏—Å–∫‚Ä¶" />
        <div id="programList" class="sheetList"></div>
      </div>
    </div>
  </div>

</body>
</html>
